<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Daves Coding Paradise: Private Implemtations details</title>
<link rel="icon" href="DCP_icon.PNG" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="DCP_logo.PNG"/></td>
  <td id="projectalign">
   <div id="projectname">Daves Coding Paradise<span id="projectnumber">&#160;0.1.1</span>
   </div>
   <div id="projectbrief">Daves Coding Paradise</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('07__private_implementations.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Private Implemtations details</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Pimple, private implementation</h2>
<pre>
In several places throughout the code we use what's called a "private implementation".
This page explains what it is, why we use it and how I implement the thing.
</pre><h2>What is it?</h2>
<pre>
The private implementation design pattern, also known as the Pimpl idiom or Opaque pointer pattern,
is a C++ programming technique that hides the implementation details of a class from its clients.
This pattern is often used to improve encapsulation, modularity, and maintainability of code.
</pre><h2>Why I use it</h2>
<pre>
One example usage is with the various renderer classes, such as the OpenGL and Vulkan ones.
We want to enforce usage of the various renderer methods, instead of suggesting that calling the APIs directly is OK.
We do NOT wish to expose the APIs to any of our code which includes the header files for the renderers, because this would allow us to call those APIs directly, instead of using the renderer classes and
potentially causing issues. If for example we called OpenGL to change a state, then god knows what's going to happen when we start rendering.
Keeping the APIs' header files included inside the .cpp files, using the Pimpl idoim, we suggest to the user of our code (and ourselves) to not mess around with the APIs directly and
it keeps things such as the global namespace nice and tidy.
For example, if I'm writing the user interface classes, which is quite a lot of code, I do not want to be calling any OpenGL functions inside there, otherwise, that UI code will NOT be API independent and if
we were to then switch renderers from OpenGL to Vulkan, we'd have to make a huge mess inside the UI code. Rule of thumb is, if we NEED the functionality of some OpenGL function call, we have to implement it
in each of the renderer classes and hide away the API calls inside their private implementations.
</pre><h2>How I use it</h2>
<pre>
In the following example, we will be creating a class named "CMyClassWithPrivateStuff" which we will use to show how we write the class so that it has a private implementation.
Create a pair of .cpp/.h files...

The header file...
<div class="fragment"><div class="line"><span class="comment">// MyClassWithPrivateStuff.h</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>CMyClassWithPrivateStuff</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">class </span>CPimpl;   <span class="comment">// Class declaration which tells the compiler that there is a class which holds the private API stuff</span></div>
<div class="line">    CPimpl *pimpl;  <span class="comment">// A pointer to the above class. As it&#39;s a pointer, it does not need to have the implementation, thereby allowing us to NOT include the header file in this header file, instead</span></div>
<div class="line">                    <span class="comment">// the actual implementation will be stored inside a .cpp file and then within that file, all the API headers are included, which prevents them from being included any where which</span></div>
<div class="line">                    <span class="comment">// includes this header file.</span></div>
<div class="line">};</div>
</div><!-- fragment -->

Next up, the source file...
<div class="fragment"><div class="line"><span class="comment">// MyClassWithPrivateStuff.cpp</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;../Core/exceptions.h&quot;</span>                     <span class="comment">// Include the exception header to allow us to use the ThrowIfMemoryNotAllocated() macro</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// As we&#39;re in a source file, we can include all the stuff required by the private implementation without worries of it being included when including this class&#39;s header file.</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>CRendererOpenGL::CPimpl</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        <span class="keywordtype">int</span> iSomeInt;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Class constructor</span></div>
<div class="line">CMyClassWithPrivateStuff::CMyClassWithPrivateStuff()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Allocate the private implementation</span></div>
<div class="line">    pimpl = <span class="keyword">new</span> CPimpl;</div>
<div class="line">    <span class="comment">// Check it was allocated below here</span></div>
<div class="line">    <a class="code hl_define" href="_exceptions_8h.html#a9bd86a9c7b41cef1ebad126eb6f9806c">ThrowIfMemoryNotAllocated</a>(pimpl);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Class destructor</span></div>
<div class="line">CMyClassWithPrivateStuff::~CMyClassWithPrivateStuff()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Free everything for the private implementation</span></div>
<div class="line">    <span class="keywordflow">if</span> (pimpl)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> pimpl;</div>
<div class="line">        pimpl = 0;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="a_exceptions_8h_html_a9bd86a9c7b41cef1ebad126eb6f9806c"><div class="ttname"><a href="_exceptions_8h.html#a9bd86a9c7b41cef1ebad126eb6f9806c">ThrowIfMemoryNotAllocated</a></div><div class="ttdeci">#define ThrowIfMemoryNotAllocated(x)</div><div class="ttdoc">Macro to check a pointer and if 0, throw an exception stating that the memory was not allocated with ...</div><div class="ttdef"><b>Definition</b> <a href="_exceptions_8h_source.html#l00079">Exceptions.h:79</a></div></div>
</div><!-- fragment -->

Then in our CMyClassWithPrivateStuff, we simply access the private implementation, by accessing the pimpl pointer.
<div class="fragment"><div class="line"><span class="keywordtype">void</span> CMyClassWithPrivateStuff::someMethod(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    pimpl-&gt;iSomeInt = 2;</div>
<div class="line">}</div>
</div><!-- fragment -->
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
